@page "/resource"
@inject ResourceService _resourceService
@inject ErrorService _errorService

@using BlazorApp2Test.Models

@if (rootFolder != null)
{
    <RecursiveFolderView Folder=@rootFolder />
}

<Loading IsLoading="@isLoading" />

@code {
    
    private bool isLoading = false;
    
    private FolderItem rootFolder;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            isLoading = true;
            rootFolder = await _resourceService.GetFolderStructureAsync(Helper.ROOT_FOLDER);
        }
        catch (Exception ex)
        {
            _errorService.ShowModal(ex.Message);
        }
        finally
        {
            isLoading = false;
        }
    }
}